<launch>
    <arg name="rviz" default="true"/>

    <arg name="fuse_imu" default="false"/>

    <include file="$(find-pkg-share unitree_bringup)/launch/driver_launch.xml">
        <arg name="fuse_imu" value="$(var fuse_imu)"/>
    </include>

    <node pkg="timestamp_fixer" exec="scan_fixer" name="scan_fixer">
        <remap from="scan_in" to="/scan_raw"/>
        <remap from="scan_out" to="/scan"/>
    </node>

    <node pkg="robot_localization" exec="ekf_node" name="ekf_filter" if="$(var fuse_imu)">
        <param from="$(find-pkg-share unitree_bringup)/config/ekf_config.yml"/>
        <remap from="odometry/filtered" to="/odom"/>
    </node>

    <include file="$(find-pkg-share unitree_bringup)/launch/rviz_launch.xml" if="$(var rviz)"/>

    <node pkg="tf2_ros" exec="static_transform_publisher" name="bl_to_bf" args="0 0 0 0 0 0 base_link base_footprint" />
    <node pkg="tf2_ros" exec="static_transform_publisher" name="bl_to_laser" args="0 0 0 0 0 0 base_link laser" />
    <node pkg="tf2_ros" exec="static_transform_publisher" name="bl_to_imu" args="0 0 0 0 0 0 base_link imu" />
</launch>